#include <iostream>
#include <math.h>
#include <stdlib.h>
#include <iomanip>
using namespace std;
int main()
{
    int mas[100][100], n, m, naim(0), sum(0), arr[100];
    cin>>n>>m;
    cout<<"Matrix"<<endl;
    for(int i=0; i<n; i++)                       //заполнение матрицы
    {   
        for(int j=0; j<m; j++)
        {
            mas[i][j]=rand()%200-100;            //[-99; 99]
            cout<<setw(5)<<mas[i][j];
        }
        cout<<endl;        
    }
    cout<<endl<<endl;        
    for(int i=0; i<m; i++)                          
    {    
        for(int j=0; j<n; j++)
            if(mas[j][i]<0 && mas[j][i]%2==-1)              //поиск нечетных отрицательных элементов в столбце
                sum+=fabs(mas[j][i]);                       //модуль суммы этих элементов
        arr[i]=sum;                                         //сохранение сумм столбцов в отдельном массиве
        sum=0;                                              //подготовка к след иттерации
    }
    
    for(int i=0; i<m; i++)                                  //проход ТОЛЬКО по одномерному массиву
        for(int j=i+1; j<m; j++)
            if(arr[j]<arr[i])                               //сортировка одномерного массива и матрицы одновременно
            {
                for(int k=i; k==i; k++)
                    for(int h=0; h<n; h++)
                        swap(mas[h][k], mas[h][j]);         //перестановка элементов матрицы
                swap(arr[j], arr[i]);                       //перестановка элементов одномерного массива для сортировки матрицы
            }            
                        
    for(int i=0; i<n; i++)                          //вывод матрицы      
    {   
        for(int j=0; j<m; j++)
            cout<<setw(5)<<mas[i][j];
        cout<<endl;        
    }                    
    return 0;
}



